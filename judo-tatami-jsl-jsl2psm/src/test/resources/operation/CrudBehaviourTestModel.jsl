model CrudBehaviourTestModel;

type binary Binary max-file-size: 1MB  mime-type: ["image/*"];
type boolean Boolean;
type date Date;
type numeric Numeric scale: 0 precision: 9;
type string String min-size: 0 max-size: 255;
type time Time;
type timestamp Timestamp;


transfer MappedTransfer maps Entity as e {
	event delete deleteInstance();
	event update updateInstance();
	event create createInstance();	
	
	relation CreateTransfer[] createEntities <= e.createEntities 
			create: true 
			update: false 
			delete: false 
			choices: CreateEntity.all();
			
	field Binary binaryDerived <= e.binary;
	field String stringDerived <= e.string;
	field Boolean booleanDerived <= e.boolean;
	field Date dateDerived <= e.date;
	field Numeric numericDerived <= e.numeric;
	field Time timeDerived <= e.time;
	field Timestamp timestampDerived <= e.timestamp;	

	field Binary binaryTransient;
	field String stringTransient;
	field Boolean booleanTransient;
	field Date dateTransient;
	field Numeric numericTransient;
	field Time timeTransient;
	field Timestamp timestampTransient;	

	field Binary binaryMapped <= e.binary bind: true;
	field String stringMapped <= e.string bind: true;
	field Boolean booleanMapped <= e.boolean bind: true;
	field Date dateMapped <= e.date bind: true;
	field Numeric numericMapped <= e.numeric bind: true;
	field Time timeMapped <= e.time bind: true;
	field Timestamp timestampMapped <= e.timestamp bind: true;	

	action void mappedChoice(MappedTransfer input choices: Entity.all());
	action void mappedChoiceStatic(MappedTransfer input choices: Entity.all()) static;

}

entity Entity {	
	relation CreateEntity[] createEntities;
	field Binary binary;
	field String string;
	field Boolean boolean;
	field Date date;
	field Numeric numeric;
	field Time time;
	field Timestamp timestamp;	
}


transfer CreateTransfer maps CreateEntity as e {
	event create createInstance;		
}

entity CreateEntity {
}


transfer UnmappedTransfer {
	action void unmappedChoiceStatic(MappedTransfer input choices: Entity.all()) static;
}

entity User {
    identifier String email;
}

transfer UserTransfer maps User as u {
    field String email <= u.email bind: true;
}

actor Actor
    realm: "COMPANY"
    claim: "email"
    identity: UserTransfer::email
{	
    access UserTransfer[] manager <= User.all();
};
