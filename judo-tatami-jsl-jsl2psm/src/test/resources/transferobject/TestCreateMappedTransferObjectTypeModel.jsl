model MappedTransferObjectTypeModel;

type string String min-size:0 max-size:250;
type numeric Integer precision:3 scale:0;


entity Entity {
    field Integer attribute;
    field EntityRelated containment;
    field EntityRelated[] containmentCollection;
    relation EntityRelated association;

    identifier Integer identifier;
    field Integer attributeDerived <= self.attribute;
    @Embedded
    relation EntityRelated containmentDerived <= self.containment;
    @Embedded
    relation EntityRelated[] containmentCollectionDerived <= self.containmentCollection;
    
}

entity EntityRelated {
    field Integer attribute;
    relation Entity `entity` opposite-add:entityRelatedOpposite;

}

transfer UnmappedRelated {
    field String transient;
}

transfer Mapped maps Entity as e {
    field Integer unmappedAttribute;
    
    @Embedded
    relation UnmappedRelated unmappedContainment;
    @Embedded
    relation required UnmappedRelated unmappedContainmentRequired;
    @Embedded
    relation UnmappedRelated[] unmappedContainmentCollection;

    field Integer mappedAttribute <=> e.attribute;
    relation MappedRelated mappedContainment <=> e.containment;
    relation MappedRelated[] mappedContainmentCollection <=> e.containmentCollection;

    relation MappedRelated mappedAssociation <=> e.association;
    relation MappedRelated mappedAssociationOpposite <=> e.entityRelatedOpposite;

    field Integer derivedAttribute <= e.attribute;
    relation MappedRelated derivedContainment <= e.containment;
    relation MappedRelated[] derivedContainmentCollection <= e.containmentCollection;
    
    relation MappedRelated derivedAssociation <= e.association;
    relation MappedRelated derivedAssociationOpposite <=> e.entityRelatedOpposite;

    field Integer derivedAttributeStatic <= Entity!any().attribute;    
    relation MappedRelated derivedContainmentStatic <= EntityRelated!any();
    relation MappedRelated[] derivedContainmentCollectionStatic <= EntityRelated!all();

    field Integer mappedAttributeDerived <= e.attributeDerived;
    relation MappedRelated mappedContainmentDerived <= e.containmentDerived;
    relation MappedRelated[] mappedContainmentCollectionDerived <= e.containmentCollectionDerived;

    field Integer mappedIdentifier <=> e.identifier;
    field Integer derivedIdentifier <= e.identifier;

}

transfer MappedRelated maps EntityRelated as e {
    field Integer mappedAttribute <=> e.attribute;
}
